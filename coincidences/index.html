<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Coincidences between candidates - Polgraw Group</title>

        <link href="../css/bootstrap-3.0.3.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <link href="../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Polgraw Group</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Home</a>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Pipeline description <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../input_data/">Input data generation</a>
                        </li>
                    
                        <li >
                            <a href="../search_for_candidates/">Search for candidate signals</a>
                        </li>
                    
                        <li class="active">
                            <a href="./">Coincidences between candidates</a>
                        </li>
                    
                        <li >
                            <a href="../pipeline_script/">Pipeline script</a>
                        </li>
                    
                        <li >
                            <a href="../articles/">Literature</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li >
                    <a rel="next" href="../search_for_candidates/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../pipeline_script/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#coincidences-between-candidates">Coincidences between candidates</a></li>
        
            <li><a href="#prerequisites">Prerequisites</a></li>
        
            <li><a href="#the-idea-behind-coincidences">The idea behind coincidences</a></li>
        
            <li><a href="#7-compilation">7. Compilation</a></li>
        
            <li><a href="#8-how-to-run-the-program">8. How to run the program?</a></li>
        
            <li><a href="#9-output">9. Output</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="coincidences-between-candidates">Coincidences between candidates</h1>
<p>In order to establish the probability of detection of a real gravitational wave, after finding the candidate signals with the <a href="../../polgraw-allsky/candidate_search/">F-statistic candidate signal search</a>, the pipeline searches for coincidences between candidates found in different time frames. </p>
<p>The coincidences code is available at <a href="https://github.com/mbejger/polgraw-allsky/tree/master">github</a>. To get it, run <code>git clone https://github.com/mbejger/polgraw-allsky.git</code>.</p>
<h4 id="prerequisites">Prerequisites</h4>
<p>The code is written in standard <code>C</code>. The only dependency is <a href="http://www.gnu.org/software/gsl/">GNU Scientific Library (GSL)</a>, used to manipulate the Fisher matrix (calculate the eigenvectors and eigenvalues). <a href="http://www.gnu.org/software/libc/manual/html_node/Accessing-Directories.html#Accessing-Directories">GNU struct dirent</a> objects are used to read the directories. </p>
<h4 id="the-idea-behind-coincidences">The idea behind coincidences</h4>
<p>After finding the candidate signals in different time frames (<code>search</code>), we want to confirm the existence of signals with the same parameters along the span of time segments. to further perform a validation search for high-coincidence, or otherwise interesting candidates (the <a href="https://github.com/mbejger/polgraw-allsky/tree/master/followup">followup</a>, currently under construction). To do this, the candidates from a list of trigger files (time frames) are read, and for each trigger file</p>
<ul>
<li>a candidate is transformed to a well-defined time moment (frequency shifted to a reference frame), </li>
<li>translated into linear (integer) coordinates, </li>
<li>duplicates within each frame are removed, </li>
<li>list of unique candidates from all the frames is created and sorted, </li>
<li>duplicates are counted - these are the coincidences. </li>
</ul>
<p><em>TODO: describe cell shifts (16 different shifts in total: 0101, 0110, 0010 etc. in f, s, d, a directions) and scaling of cells (used to define the linear parameters for a given cell to subsequently compare the candidate values)</em> </p>
<h3 id="7-compilation">7. Compilation</h3>
<p>Run <code>make coincidences</code>; resulting binary is called <code>coincidences</code>. Modify the <code>Makefile</code> to fit your system.</p>
<h3 id="8-how-to-run-the-program">8. How to run the program?</h3>
<p>Sample call of <code>coincidences</code> is as follows:</p>
<pre><code>&gt; ./coincidences -data . -output 0666-coincidences -mincoin 3 -snrcutoff 5 -trigname triggers_ -refloc 6d_xdat_0.25/010 -refr 010 -fpo 171.296875 -shift 0110 -scale 4444 -dt 2 2&gt;&gt; summary
</code></pre>

<p>This assumes that for the band <mathjax>$bbbb=0666$</mathjax> the band frequency <mathjax>$fpo$</mathjax> is 171.296875, because we define 
<mathjax>$$
fpo = 10 + (1 - 2^{-5})\cdot bbbb\cdot \frac{1}{2dt}\ \mathrm{[Hz]}.
$$</mathjax>
The reference grid file <code>grid.bin</code>, corresponding to the reference frame <code>010</code> is located at the <code>-refloc</code> location. Some output is directed to <code>stdin</code>. The highest-coincidence is streamed to the <code>summary</code> file via the <code>stderr</code> (<code>2&gt;&gt; summary</code>). </p>
<p>In principle one has to run the code 16 times for all the <mathjax>$2^4$</mathjax> shifts (all combinations of <code>0000--1111</code>).   </p>
<h4 id="81-full-list-of-switches">8.1. Full list of switches</h4>
<p>Type </p>
<pre><code>&gt; ./coincidences --help 
</code></pre>

<p>to obtain the following description: </p>
<table>
<thead>
<tr>
<th>Switch</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-data</td>
<td align="left">Data directory (default is <code>./candidates</code>)</td>
</tr>
<tr>
<td>-output</td>
<td align="left">Output directory (default is <code>./coinc-results</code>)</td>
</tr>
<tr>
<td>-shift</td>
<td align="left">Cell shifts in <code>fsda</code> directions (4 digit number, e.g. <code>0101</code>, default <code>0000</code>)</td>
</tr>
<tr>
<td>-scale</td>
<td align="left">Cell scaling in <code>fsda</code> directions (4 digit number, e.g. <code>4824</code>, default <code>1111</code>)</td>
</tr>
<tr>
<td>-refr</td>
<td align="left">Reference frame number</td>
</tr>
<tr>
<td>-fpo</td>
<td align="left">Reference band frequency <code>fpo</code> value</td>
</tr>
<tr>
<td>-dt</td>
<td align="left">Data sampling time dt (default value: <code>0.5</code>)</td>
</tr>
<tr>
<td>-trigname</td>
<td align="left">Part of triggers' name (for identifying files)</td>
</tr>
<tr>
<td>-refloc</td>
<td align="left">Location of the reference grid.bin and starting_date files</td>
</tr>
<tr>
<td>-mincoin</td>
<td align="left">Minimal number of coincidences recorded</td>
</tr>
<tr>
<td>-narrowdown</td>
<td align="left">Narrow-down the frequency band (range [0, 0.5] +- around center)</td>
</tr>
<tr>
<td>-snrcutoff</td>
<td align="left">Signal-to-noise threshold cutoff (default value: 6)</td>
</tr>
</tbody>
</table>
<p>Also:</p>
<table>
<thead>
<tr>
<th></th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr>
<td>--help</td>
<td align="left">This help</td>
</tr>
</tbody>
</table>
<h3 id="9-output">9. Output</h3>
<p>Output to the screen (<code>stdout</code>) in the case of </p>
<pre><code>&gt; ./coincidences -data . -output 0666-coincidences -mincoin 3 -snrcutoff 5 -trigname triggers_ -refloc 6d_xdat_0.25/010 -refr 010 -fpo 171.296875 -shift 0110 -scale 4444 -dt 2 2&gt;&gt; summary
</code></pre>

<p>is</p>
<pre><code>The SNR threshold cutoff is 5.000000000000, corresponding to F-statistic value of 14.500000000000
Reading the reference grid.bin at 6d_xdat_0.25/010
fftpad from the grid file: 1
Settings dt: 2.000000, oms: 2152.580016
Reference frame number: 10
Cell shifts  in f, s, d, a directions: 0 1 1 0 
Cell scaling in f, s, d, a directions: 4 4 4 4 
Reading triggers_005_0666_2.bin... Frame 5: 941/1879
Reading triggers_019_0666_2.bin... Frame 19: 1320/1794
Reading triggers_003_0666_2.bin... Frame 3: 1512/1920
Reading triggers_008_0666_2.bin... Frame 8: 3090/6849
Reading triggers_002_0666_2.bin... Frame 2: 1014/1173
Reading triggers_014_0666_2.bin... Frame 14: 779/1542
Reading triggers_006_0666_2.bin... Frame 6: 2884/8822
Reading triggers_011_0666_2.bin... Frame 11: 918/2896
Total number of candidates from all frames: 12458
</code></pre>

<p>The highest-coincidence is streamed to a <code>summary</code> file via <code>stderr</code>:  </p>
<pre><code>&gt; cat summary 
triggers_ 0110 171.296875 8 8 1.05795986e+00 -7.69412393e-09 -7.42581733e-01 5.39896106e+00 2.417267e+01 5 1879 941 19 1794 1320 3 1920 1512 8 6849 3090 2 1173 1014 14 1542 779 6 8822 2884 11 2896 918
</code></pre>

<p>It contains the <code>trigname</code> identifier, the <code>shift</code> value, the <code>fpo</code> band frequency, the number of files read (8), and the highest coincidence found (8). Next 5 numbers are arithmetic mean values of the frequency <mathjax>$\,f$</mathjax> (in radians), frequency derivative <mathjax>$\,\dot{f}$</mathjax> (spindown), sky positions <mathjax>$\delta$</mathjax> and <mathjax>$\alpha$</mathjax>, and the mean signal-to-noise ratio, <mathjax>$\widetilde{\mathrm{snr}}=\sqrt{\sum_i \mathrm{snr}_i^2}$</mathjax>. The following integers are grouped in threes and denote the triggers/time frame number, number of all candidates in that triggers' file, and the number of unique candidates. </p>
<p>Coincidences above <code>mincoin</code> are recorded in a binary file <code>.coi</code>, separately for each shift, in the <code>-output</code> directory. Each coincidence is a set of following numbers: 
<mathjax>$$
N_{coin},\quad\bar{f},\quad\bar{s},\quad\bar{d},\quad\bar{a},\quad\widetilde{\mathrm{snr}},\quad\mathrm{fr}_{1},\,\dots\,\mathrm{fr}_{N_{coin}},\quad\mathrm{p}_{1},\,\dots\,\mathrm{p}_{N_{coin}}
$$</mathjax>
where </p>
<ul>
<li><mathjax>$N_{coin}$</mathjax> is the size of coincidence (written as one <code>unsigned short int</code>), </li>
<li><mathjax>$\bar{f}$</mathjax>, <mathjax>$\bar{s}$</mathjax>, <mathjax>$\bar{d}$</mathjax>, <mathjax>$\bar{a}$</mathjax> and <mathjax>$\widetilde{\mathrm{snr}}$</mathjax> are the mean parameters of the signal (<mathjax>$5\times$</mathjax><code>float</code>),</li>
<li><mathjax>$\mathrm{fr}_{1},\,\dots\,\mathrm{fr}_{N_{coin}}$</mathjax> are the frame numbers (<mathjax>$N_{coin}\times$</mathjax><code>unsigned short int</code>), </li>
<li><mathjax>$\mathrm{p}_{1},\,\dots\,\mathrm{p}_{N_{coin}}$</mathjax> are the positions of candidate signals that took part in the coincidences, in their corresponding trigger files (<mathjax>$N_{coin}\times$</mathjax><code>int</code>) </li>
</ul>
<p>in order to be able to recover the actual original candidate signals, if needed. </p></div>
        </div>

	<footer class="col-md-12">
		<hr>
		
		<p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
	</footer>


        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
        <script src="../js/mathjaxhelper.js"></script>
    </body>
</html>